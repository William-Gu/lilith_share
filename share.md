# 渲染解析引擎的工作

提问：浏览器能做到多复杂的系统？
SpaceX航电通过C和C++，UI通过HTML+CSS+JS，Test通过Python。

css 选择器从右到左，我也不能光凭嘴说，我们来看一个栗子。

一.
1. DOM Tree的构建

2. CSSOM Tree 的构建
- CSS选择器执行
问1：第一种效率更高还是第二种？
问2：从左到右还是从右到左？
这个实验所反应的效率并不重要，很少会创建2000层深度的div，要说的是反应背后的原理。

- 项目中的栗子


- CSS规则索引
如果不建索引，那每个元素就要去匹配所有的CSS规则，假设有m个元素和n条规则，那消耗的时间就是m*n.
当我们有了这个规则后就开始了建立索引的过程，这个索引还是一棵树。
这棵树从root建起来，下面就是规则最右侧的选择器，分成三个岔，最右侧有几个规则就会被分成几个岔。
然后这棵树就被建立成下面这个样子。


下面就是一个dom找css的过程。    ````````<.......>`````` 可能后面的还没有下载完成、没有解析完成，他不会影响到，我们不管他。
找到这个css规则后就被加入到了这个dom树里计算规则里。
当我们把这棵css索引树建立好以后，我们每拿到一个dom节点我们就可以以很快的速度去match有哪几个css规则相关。 

当我们把这个过程了解了以后，我们再来看看上面的这个问题。
我们肯定要从当前的元素去查找所适应的选择符，像第一种他从div开始向上找，可能这棵树有很多div，像第二种他直接从.b开始找，根本不会去到其他分支去找。看这棵树右边可能非常大，我们现在根本就不管他，直接进入.b找匹配的规则。
